import Pokemon from "../models/pokemon.js"; // Import the pokemon model
import { validationResult } from "express-validator";

export const getPokemons = (req, res) => {
  Pokemon.find()
    .then((result) => {
      res.json(result);
    })
    .catch((error) => {
      console.log(error);
      throw new Error(error);
      // res.status(400).json({ message: error.message });
    });
};

export const getPokemon= (request, response) => {
  const id = request.params.id ;
  Pokemon.findById(id)
    .then((result) => {
      response.json(result);
    })
    .catch((error) => {
      console.log(error)
      throw new Error(error);
    });
};

export const getError = (req, res) => {
  throw new Error("This is an error");
};


export const createPokemon = (request, response) => {
  const bodyContent = request.body;
  const errors = validationResult(request);
  console.log(errors);
  // on cree un nouvelle instance de pokemon
  const newPokemon = new Pokemon(bodyContent);

  // on sauvegarde la nouvelle instance de pokemon
  newPokemon
    .save()
    .then((result) => {
      response.status(201).json(result);
    })
    .catch((error) => {
      console.log(error);
      throw new Error(error);
      // response.status(400).json({ message: error.message });
    });

};


export const udpatePokemon = (request, response) => {
  const id = request.params.id;
  const bodyContent = request.body

  Pokemon.findByIdAndUpdate(id, bodyContent)
  .then((result) => {
    response.json(result);
  })
  .catch((error) => {
    console.log(error);
    throw new Error(error);
    // res.status(400).json({ message: error.message });
  });
};

export const deletePokemon = (request, response) => {
  const id = request.params.id;
  Pokemon.findByIdAndDelete(id)
  .then((result) => {
    response.json(result);
  })
  .catch((error) => {
    console.log(error);
    throw new Error(error);
    // res.status(400).json({ message: error.message });
  });
};